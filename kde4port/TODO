This file only concerns itself with porting KolourPaint from KDE 3 to KDE 4
and code cleanups.  TODO: we broke this rule at the bottom of the file and
started talking about features.

Features to be implemented are in branches/kolourpaint/control/TODO.


1. Move all code that accesses document content to imagelib/.  Merge with kppixmapfx.cpp.
   Do a case-insensitive grep for "mask" or case-sensitive grep for QBitmap.

   Examples:

   * imagelib/transforms/{kptoolcrop,kptoolautocrop}.cpp should only contain
     the QPixmap manipulation code

   * The part of kpToolClearCommand::execute() manipulating the mask should be moved
     into imagelib/


11. Push as many classes as possible into kdelibs.
* reduce size of code (51352-28 generated lines 2006-03-23; hopefully reduce by 10KLOC)
  - go through each class finding stuff that can be factored into kdelibs
    (also go through bug reports), SYNC, HACK, COMPAT etc.
  - push kpSqueezedTextLabel out
  - push kpCommandHistory out; now Qt has some command scheme in addition to
    kdelibs, koffice and kolourpaint; and see kde-core-devel archives for yet another
command scheme
  - push multicolumn toolbar out (see how rodda's KAction changes affect it
- ask rodda)
    - ktoolbar support multicolumn - see how krita does it


10. QA entire project due to Qt4 breakages.  Everything needs to be whitebox
    tested again esp. the file saving path - format conversion, maximal
    content preservation, formatting loss warnings etc.

* KParts
  - import-export for KOffice & KolourPaint
    - look up thread in mail where I said I'd rename to "Save A Copy" etc.
  - oldURL for error handling in general
* DPI GUI to close bug
  - View / Actual Size != actual size - rename to 100%
    but View / 100% looks weird, View / Unzoomed (100%) looks weird and
    confused with Zoomed Thumbnail Mode

* make KolourPaint fun to use & popular again by implementing easy feature
  requests quickly
  - e.g. aligning objects in pixel-based editor happens too often
         - need Krita's "guide lines"
  - find out common requests that require other programs e.g. dropshadow:
    http://people.kde.nl/marco.html

* look at new backend for 16-bit, translucency, 8-bit paletted with alpha
  - convince Qt to implement 8-bit paletted with alpha?
    - Very important for DOS/SDL-Linux game "Clarence's Adventure"
  - QImage-based renderer; test ->QPixmap conversion speed, look at Krita
    to see how speed, timer-based updater?
  - does premultiplied format
    - lose quality?  don't think so since 16-bit values
    - when set alpha to 0, color dies?  is this so important?



* kpEffectReduceColors::convertImageDepth() must die

* kpdocument.cpp manipulates document using kpPixmapFX instead of kpPainter (for invert?); look for such a TODO


KDE 4 constructorWidth,Height -> originalWidth,Height


* Decouple more classes (kpDocument, kpTool*, dialogs) from kpMainWindow and friends by introducing facades, like kpCommandEnvironment.

* Clean up kpTool.h, kpDocument.h and kpMainWindow.h and use dptr


* Rename *Base classes to Abstract*


* When zoomed in, very slow
  - when typing text, cursor moves ahead and the bits of the text where the cursor was
    overlapping are updated, but the rest of the typed text is not displayed yet
    - probably has something to do with delayed updates
      - or mis-sync between text cursor position and updates
        (due to kpViewManager and kpTextSelection functionality split)
